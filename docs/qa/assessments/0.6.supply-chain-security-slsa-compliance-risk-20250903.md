# Risk Profile: Story 0.6 - Supply-chain Security & SLSA Compliance

Date: 2025-09-03
Reviewer: Quinn (Test Architect)

## Executive Summary

- Total Risks Identified: 7
- Critical Risks: 1
- High Risks: 4
- Medium Risks: 1
- Low Risks: 1
- Risk Score: 65/100 (Moderate Risk)

## Critical Risks Requiring Immediate Attention

### 1. SEC-001: SLSA Build Provenance Compromise

**Score: 9 (Critical)**
**Probability**: High - GitHub Actions environment can be compromised through token theft, build environment manipulation, or supply-chain attacks targeting the build infrastructure itself.
**Impact**: High - Compromised build provenance would allow attackers to inject malicious code while maintaining apparent legitimacy, creating a severe supply-chain attack vector.
**Mitigation**:

- Implement GitHub Actions environment isolation with minimal permissions (id-token: write only)
- Use Sigstore keyless signing with ephemeral certificates to eliminate long-lived private keys
- Configure build attestation verification in deployment pipeline with automatic rejection of unverified artifacts
- Implement regular rotation of GitHub tokens and secrets with automated monitoring for unusual access patterns
  **Testing Focus**:
- Automated verification of SLSA build attestations in CI/CD pipeline
- Penetration testing of build environment isolation mechanisms
- Token theft simulation and recovery procedures testing

## Risk Distribution

### By Category

- Security: 3 risks (1 critical, 2 high)
- Performance: 1 risk (1 high)
- Data: 1 risk (1 high)
- Technical: 1 risk (1 high)
- Operational: 1 risk (1 medium)

### By Component

- GitHub Actions: 4 risks
- SBOM Generation: 2 risks
- Dependency Management: 2 risks
- Sigstore Integration: 2 risks

## Detailed Risk Register

| Risk ID  | Category    | Description                             | Probability | Impact     | Score | Priority |
| -------- | ----------- | --------------------------------------- | ----------- | ---------- | ----- | -------- |
| SEC-001  | Security    | SLSA Build Provenance Compromise        | High (3)    | High (3)   | 9     | Critical |
| SEC-002  | Security    | Private Key/Secret Exposure in SBOM     | Medium (2)  | High (3)   | 6     | High     |
| DATA-001 | Data        | SBOM Integrity Compromise               | Medium (2)  | High (3)   | 6     | High     |
| SEC-003  | Security    | Dependency Confusion Attack             | Medium (2)  | High (3)   | 6     | High     |
| TECH-001 | Technical   | Reproducible Build Failure              | High (3)    | Medium (2) | 6     | High     |
| PERF-001 | Performance | Build Pipeline Performance Degradation  | High (3)    | Medium (2) | 6     | High     |
| OPS-001  | Operational | SLSA Verification Failure in Production | Medium (2)  | Medium (2) | 4     | Medium   |

## Detailed Risk Analysis

### SEC-002: Private Key/Secret Exposure in SBOM

**Score: 6 (High)**

- **Probability**: Medium - SBOM generation processes may inadvertently include secrets, private keys, or sensitive configuration data
- **Impact**: High - Exposed secrets could lead to unauthorized access to systems and compromise of the entire supply-chain security model
- **Mitigation**:
  - Integrate secret scanning (truffleHog/GitLeaks) into SBOM generation pipeline
  - Implement SBOM content validation and sanitization before signing
  - Use separate signing keys for different artifact types with proper key management
  - Configure post-generation secret detection scanning with automatic blocking of suspicious SBOMs

### DATA-001: SBOM Integrity Compromise

**Score: 6 (High)**

- **Probability**: Medium - Man-in-the-middle attacks during SBOM generation or transmission could modify dependency information
- **Impact**: High - Compromised SBOM would provide false dependency information, creating security blind spots and enabling supply-chain attacks
- **Mitigation**:
  - Implement cryptographic signing of SBOMs using Sigstore immediately after generation
  - Use secure transport (TLS) for all SBOM transmission with certificate pinning
  - Configure SBOM integrity verification at multiple checkpoints in the pipeline
  - Implement tamper detection mechanisms with automatic rejection of modified SBOMs

### SEC-003: Dependency Confusion Attack

**Score: 6 (High)**

- **Probability**: Medium - Attackers may publish packages with names similar to internal dependencies or exploit package registry vulnerabilities
- **Impact**: High - Successful dependency confusion would allow malicious code injection during build process
- **Mitigation**:
  - Implement scoped package usage with private registry configuration
  - Configure typosquatting detection for high-risk dependency changes
  - Use exact version pinning for all crypto-core dependencies in Cargo.lock
  - Implement package verification with multiple trusted sources and signature checking

### TECH-001: Reproducible Build Failure

**Score: 6 (High)**

- **Probability**: High - Timestamp variations, environment differences, or dependency version drift commonly cause reproducibility failures
- **Impact**: Medium - SLSA compliance failure would block deployments and require manual verification
- **Mitigation**:
  - Configure SOURCE_DATE_EPOCH for deterministic timestamps across all build tools
  - Use container-based builds with pinned base images and locked tool versions
  - Implement strict dependency lockfile enforcement with integrity verification
  - Set up automated reproducibility testing with binary comparison of artifacts

### PERF-001: Build Pipeline Performance Degradation

**Score: 6 (High)**

- **Probability**: High - SLSA provenance generation, multi-ecosystem SBOM creation, and signing operations will add significant build time
- **Impact**: Medium - Slower deployments would impact developer productivity and deployment frequency
- **Mitigation**:
  - Implement parallel processing of SBOM generation for npm and Cargo ecosystems
  - Use caching strategies for SLSA artifacts and signed components
  - Optimize build stages with selective triggering based on changed components
  - Configure build performance monitoring with alerting on degradation thresholds

### OPS-001: SLSA Verification Failure in Production

**Score: 4 (Medium)**

- **Probability**: Medium - Network connectivity issues or verification service downtime could prevent SLSA verification
- **Impact**: Medium - Deployment blocks would require manual verification and potentially delay releases
- **Mitigation**:
  - Implement verification service redundancy with multiple SLSA verification endpoints
  - Configure graceful degradation with cached verification results for known-good artifacts
  - Set up monitoring and alerting for verification service availability
  - Create runbook procedures for manual verification during service outages

## Risk-Based Testing Strategy

### Priority 1: Critical Risk Tests

**SEC-001 Testing Requirements:**

- Build environment isolation testing with attempt to escape sandbox
- Token theft simulation and detection testing
- SLSA provenance verification failure scenarios
- Build attestation tampering detection tests
- Sigstore integration and keyless signing verification

**Test Data Requirements:**

- Malicious build scripts for isolation testing
- Sample compromised GitHub tokens for simulation
- Invalid SLSA attestations for verification testing

### Priority 2: High Risk Tests

**Multi-Ecosystem SBOM Testing:**

- SBOM generation accuracy for npm and Cargo dependencies
- Cross-platform reproducible build verification
- Secret scanning effectiveness in SBOM generation
- Dependency confusion detection and prevention
- Performance impact measurement under load

**Integration Test Scenarios:**

- End-to-end SLSA workflow with full attestation chain
- SBOM signing and verification across different formats (SPDX/CycloneDX)
- Supply-chain attack simulation with malicious dependencies

### Priority 3: Medium/Low Risk Tests

**Operational Resilience:**

- SLSA verification service failover testing
- Build pipeline recovery from partial failures
- Performance degradation under high dependency counts
- Network connectivity failure simulation

**Standard Functional Tests:**

- SLSA Level 2 compliance validation checklist
- SBOM format compatibility testing
- Reproducible build determinism verification
- Integration with existing CI/CD pipeline workflows

## Risk Acceptance Criteria

### Must Fix Before Production

- **SEC-001**: SLSA Build Provenance Compromise - Critical security risk requiring complete mitigation
- **SEC-002**: Private Key/Secret Exposure in SBOM - High security risk with potential for credential compromise
- **DATA-001**: SBOM Integrity Compromise - High risk to supply-chain visibility and security posture

### Can Deploy with Mitigation

- **SEC-003**: Dependency Confusion Attack - Acceptable with scoped packages and verification processes
- **TECH-001**: Reproducible Build Failure - Acceptable with manual verification procedures for edge cases
- **PERF-001**: Build Pipeline Performance Degradation - Acceptable with performance monitoring and optimization plan

### Accepted Risks

- **OPS-001**: SLSA Verification Failure in Production - Low-medium operational risk acceptable with proper runbook procedures and monitoring

Risk acceptance requires sign-off from Security Architecture team for all security risks rated 6 or higher.

## Monitoring Requirements

Post-deployment monitoring for:

**Security Metrics:**

- SLSA provenance generation success rate (target: >99.5%)
- Secret scanning detection rate and false positive analysis
- Dependency confusion attack attempts and prevention effectiveness
- SBOM integrity verification failure rate

**Performance Metrics:**

- Build pipeline duration with SLSA overhead (baseline + 15% acceptable)
- SBOM generation time for multi-ecosystem projects
- Verification service response time and availability (target: <2s, >99.9%)

**Operational Metrics:**

- Reproducible build success rate (target: >98%)
- Manual verification frequency due to automation failures
- Deploy pipeline block rate due to SLSA/SBOM issues

## Risk Review Triggers

Review and update risk profile when:

- New vulnerabilities discovered in GitHub Actions or Sigstore infrastructure
- Changes to SLSA framework requirements or specifications
- Major dependency updates affecting crypto-core components
- Security incidents in similar supply-chain security implementations
- Performance degradation exceeding acceptable thresholds (>25% build time increase)
- Regulatory or compliance requirements change for software supply-chain security

## Risk-Based Recommendations

### Testing Priority

1. **Immediate**: Implement comprehensive SLSA provenance verification testing
2. **High**: Set up multi-ecosystem SBOM accuracy and integrity testing
3. **Medium**: Create performance regression testing for build pipeline impact
4. **Ongoing**: Establish continuous security monitoring for supply-chain threats

### Development Focus

1. **Code Review Emphasis**: Focus on build script security, secret handling, and environment isolation
2. **Security Controls**: Implement defense-in-depth for build integrity and SBOM generation
3. **Performance Optimization**: Profile and optimize SLSA workflow integration points
4. **Error Handling**: Robust failure handling for partial SLSA/SBOM generation failures

### Deployment Strategy

1. **Phased Rollout**: Enable SLSA Level 2 on non-critical builds first
2. **Feature Flags**: Use feature flags for SBOM generation and verification components
3. **Rollback Procedures**: Maintain ability to disable SLSA verification in emergency situations
4. **Monitoring Integration**: Full observability before production enablement

### Integration with Quality Gates

**Gate Decision Mapping:**

- Any risk with score ≥ 9 → Gate = FAIL (SEC-001 requires resolution)
- 4 risks with score = 6 → Gate = CONCERNS (requires mitigation plan)
- Overall assessment → Gate = CONCERNS pending critical risk mitigation

**Unmitigated Risks Documentation:**

- SEC-001: Must be fully mitigated before production deployment
- High risks (score 6): Require approved mitigation plans and monitoring
- Medium risks: Acceptable with documented procedures and monitoring

## Quality Gate Integration

This risk assessment integrates with the quality gate system:

**Deterministic Gate Mapping:**

- SEC-001 (Score 9): FAIL status until fully mitigated
- 5 High Risks (Score 6): CONCERNS status requiring mitigation plans
- Overall Risk Score 65/100: CONCERNS status due to multiple high-priority risks

**Gate Decision Requirements:**

- Critical risks must be fully resolved for PASS status
- High risks require documented mitigation strategies
- Performance risks require baseline measurements and acceptance thresholds
- Security risks require security team review and approval
