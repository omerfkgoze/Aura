# <!-- Powered by BMADâ„¢ Core -->

# Story 0.11: Development Server Configuration

## Parent Epic

**Epic 0: Project Foundation** - This story ensures mobile and web applications run properly in development mode as part of the foundational project setup, enabling efficient development workflow for all subsequent features.

## Status

**Draft**

## Story

**As a** developer,
**I want** mobile and web applications to run properly in development mode,
**so that** I can see my changes in real-time while developing and have an efficient development workflow.

## Acceptance Criteria

1. **Expo Mobile Development Server**
   - `npx expo start` command launches mobile app and displays existing components correctly
   - Hot reload functionality works for React Native components and screens
   - Metro bundler properly resolves shared packages from monorepo structure
   - Development server integrates with existing Nx workspace configuration

2. **Web Application Development Server**
   - Web application development server starts and shows existing pages/components
   - Hot reload functionality works for Next.js pages and components
   - Vite bundler properly handles Tamagui components and shared packages
   - Development server follows existing Nx workspace patterns

3. **Monorepo Integration**
   - Existing Nx monorepo structure and shared packages continue to work unchanged
   - packages/ui/ Tamagui components load properly in both mobile and web platforms
   - packages/shared-types/ TypeScript definitions resolve correctly
   - Development setup follows existing Nx workspace pattern for dev scripts

4. **Development Workflow**
   - Development setup is covered by appropriate documentation/scripts
   - package.json dev scripts are updated to support concurrent mobile and web development
   - No regression in existing build/production functionality verified
   - Development environment supports debugging and proper error reporting

## Tasks / Subtasks

- [ ] **Task 1: Expo Mobile Development Configuration** (AC: 1)
  - [ ] Fix Expo configuration in `apps/mobile/` to properly load existing components from `apps/mobile/src/`
  - [ ] Configure Metro bundler to resolve monorepo shared packages correctly
  - [ ] Update `expo/metro-config` to support Nx workspace structure
  - [ ] Test `npx expo start` shows mobile app with existing components
  - [ ] Verify hot reload works for mobile components and shared packages
  - [ ] Integrate Expo dev server with existing Nx development workflow

- [ ] **Task 2: Next.js Web Development Server** (AC: 2)
  - [ ] Configure Next.js development server in `apps/web/` for hot reload
  - [ ] Update Vite configuration to handle Tamagui components properly
  - [ ] Configure Next.js to resolve shared packages from monorepo structure
  - [ ] Test web development server displays existing pages and components
  - [ ] Verify hot reload works for web components and shared packages
  - [ ] Ensure development server integrates with Nx workspace patterns

- [ ] **Task 3: Shared Package Resolution** (AC: 3)
  - [ ] Validate `packages/ui/` Tamagui components load in both platforms
  - [ ] Configure TypeScript path mapping for shared packages in development
  - [ ] Test `packages/shared-types/` definitions resolve correctly
  - [ ] Verify `packages/crypto-core/` WASM bindings work in development
  - [ ] Update workspace configuration for proper package resolution
  - [ ] Test monorepo integrity with concurrent mobile and web development

- [ ] **Task 4: Development Scripts and Documentation** (AC: 4)
  - [ ] Update root `package.json` with development scripts for mobile and web
  - [ ] Create concurrent development script: `"dev": "nx run-many --target=dev --projects=mobile,web"`
  - [ ] Document development setup in `DEVELOPMENT.md` or README
  - [ ] Verify no regression in existing build/production functionality
  - [ ] Test development environment supports proper debugging and error reporting
  - [ ] Create troubleshooting guide for common development setup issues

## Dev Notes

### Previous Story Context

No specific previous story context required - this is foundational development environment setup.

### Tech Stack Integration

- **Mobile Framework**: Expo/React Native 50.x provides cross-platform development with Metro bundler [Source: docs/architecture/tech-stack.md]
- **Web Framework**: Next.js 14.x with SSR disabled for PII protection, using Vite bundler [Source: docs/architecture/tech-stack.md]
- **UI Components**: Tamagui for unified cross-platform design system across web and mobile [Source: docs/architecture/tech-stack.md]
- **Build Tool**: Nx 17.x for monorepo orchestration with build caching and dependency management [Source: docs/architecture/tech-stack.md]
- **Bundlers**: Vite for web builds, Metro for mobile builds - platform-optimized [Source: docs/architecture/tech-stack.md]

### Project Structure Alignment

- **Mobile App**: `apps/mobile/src/` contains React Native application requiring proper Metro configuration [Source: docs/architecture/source-tree.md]
- **Web App**: `apps/web/src/` contains Next.js application with API routes requiring Vite configuration [Source: docs/architecture/source-tree.md]
- **Shared UI**: `packages/ui/src/` contains Tamagui components that must work on both platforms [Source: docs/architecture/source-tree.md]
- **Shared Types**: `packages/shared-types/src/` contains TypeScript definitions requiring proper path resolution [Source: docs/architecture/source-tree.md]
- **Crypto Core**: `packages/crypto-core/` contains Rust/WASM bindings requiring special bundler configuration [Source: docs/architecture/source-tree.md]

### Configuration Requirements

- **Nx Workspace**: Development servers must integrate with Nx workspace configuration and build caching [Source: docs/architecture/source-tree.md]
- **TypeScript**: All development servers must support TypeScript 5.3+ with strict mode and proper path mapping [Source: docs/architecture/tech-stack.md]
- **Environment Variables**: Development setup must access config through config objects, never process.env directly [Source: docs/architecture/coding-standards.md]
- **Package Resolution**: Monorepo packages must resolve correctly using workspace configuration [Source: docs/architecture/source-tree.md]

### Development Standards

- **Hot Reload**: Both platforms must support real-time code changes during development
- **Shared Components**: Tamagui components must render correctly on both web and mobile platforms
- **Error Handling**: Development servers must provide proper error reporting and debugging capabilities
- **Build Performance**: Development setup should leverage Nx build caching for optimal performance

### Testing

#### Test File Locations

No specific guidance found in architecture docs for test file locations in this context.

#### Test Standards

- **Frontend Testing**: Vitest + Testing Library for fast unit/integration tests with Vite-native support [Source: docs/architecture/tech-stack.md]
- **E2E Testing**: Playwright for cross-platform E2E testing with reliable mobile support [Source: docs/architecture/tech-stack.md]

#### Testing Frameworks and Patterns

- **Development Testing**: Verify development servers start correctly and display existing components
- **Hot Reload Testing**: Test real-time code changes work on both platforms
- **Package Resolution Testing**: Verify shared packages load correctly in development mode
- **Integration Testing**: Test Nx workspace integration with development workflow

#### Specific Testing Requirements

- **Mobile Development**: Test `npx expo start` launches correctly and displays components
- **Web Development**: Test Next.js dev server starts and shows pages/components
- **Monorepo Testing**: Test shared package resolution and TypeScript path mapping
- **Build Regression**: Verify production builds continue to work after development setup changes

## Change Log

| Date       | Version | Description                                                 | Author       |
| ---------- | ------- | ----------------------------------------------------------- | ------------ |
| 2025-09-18 | 1.0     | Initial story creation for development server configuration | Scrum Master |

## Dev Agent Record

### Agent Model Used

[To be filled by Dev Agent]

### Debug Log References

[To be filled by Dev Agent]

### Completion Notes

[To be filled by Dev Agent]

### File List

[To be filled by Dev Agent]

## QA Results

[To be filled by QA Agent]
